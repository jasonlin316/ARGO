# ARGO: An Auto-Tuning Runtime System for Scalable GNN Training on Multi-Core Processor

## Installation

1. Clone the repository:

```shell
git clone https://github.com/jasonlin316/DDP_GNN.git
```

2. Download Anaconda and install
```shell
wget https://repo.anaconda.com/archive/Anaconda3-2023.03-Linux-x86_64.sh
bash Anaconda3-2023.03-Linux-x86_64.sh
```

3. Create a virtual environment:

```shell
conda create -n py38 python=3.8.1
```

4. Active the virtual environment:

```shell
conda activate py38
```

5. Install required packages:

```shell
conda install pytorch==1.13.0 torchvision==0.14.0 torchaudio==0.13.0 cpuonly -c pytorch
conda install -c dglteam dgl
conda install -c conda-forge ogb
conda install -c conda-forge torchmetrics
conda install -c conda-forge scikit-optimize
conda install -c conda-forge matplotlib
```

6. Fix a bug in the Scikit-Optimization library. Find "transformer.py" which should locate in
   ```~/anaconda3/envs/py38/lib/python3.8/site-packages/skopt/space/transformers.py```  
   Once open the file, replace all ```np.int``` with ```int``` (there are two of them, located in line 262 and line 275)

7. Naviagte to the auto-tuner folder:
```
cd DDP_GNN/auto_tuner
```
8. Try to run the experiment once to make sure the program runs correctly:  
```
python -W ignore gnn_train.py --dataset ogbn-products --cpu_process 2 --n_sampler 2 --n_trainer 4
```  
If we can see "total_time: (some number)" then the program executed successfully.  
Note: when running the program for the first time, the program will ask if you want to download the dataset; please enter "y" for the program to proceed.
   
9. Run the exhaustive search (this can take up to a day)

```shell
bash verify.sh
```
Afterwards, a .csv file named "grid_serach_{dataset}.csv" will be generated for each dataset.

10. Next, we can run the auto-tuner to see what configuration it finds:
    
```shell
bash bo.sh
```

11. Now we can collect all the outputs; the first two are generated by the auto-tuner, and the last one from the exhaustive search
```shell
1. convergence_plot_{dataset}.png
2. bo_{dataset}.txt
3. grid_serach_{dataset}.csv
```

